<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="egovframework.let.room.service.impl.RoomMapper">

	<resultMap id="board" type="egovframework.let.room.service.RoomVO">
		<result property="roomId" column="ROOM_ID"/>
		<result property="registerInfo" column="REGISTER_INFO"/>
		<result property="address1" column="ADDRESS1"/>
		<result property="address2" column="ADDRESS2"/>
		<result property="deal" column="DEAL"/>
		<result property="price" column="PRICE"/>
		<result property="monthPrice" column="MONTH_PRICE"/>
		<result property="cost" column="COST"/>
		<result property="costInfo" column="COST_INFO"/>
		<result property="moveDate" column="MOVE_DATE"/>
		<result property="wholeClass" column="WHOLE_CLASS"/>
		<result property="myClass" column="MY_CLASS"/>
		<result property="form" column="FORM"/>
		<result property="park" column="PARK"/>
		<result property="choiceOption" column="CHOICE_OPTION"/>
		<result property="atchFileId" column="ATCH_FILE_ID"/>
		<result property="boardCn" column="BOARD_CN"/>
	</resultMap>

	<select id="selectRoomList" resultType="egovMap">
		SELECT 
			ROOM_ID, 
			REGISTER_INFO, 
			ADDRESS1, 
			ADDRESS2, 
			DEAL, 
			PRICE, 
			MONTH_PRICE, 
			COST, 
			COST_INFO, 
			MOVE_DATE, 
			WHOLE_CLASS, 
			MY_CLASS, 
			FORM, 
			PARK, 
			CHOICE_OPTION, 
			ATCH_FILE_ID, 
			BOARD_CN
		FROM homepage_db.room;
	</select>
	
	<!-- <select id="selectRoomListCnt" resultType="java.lang.Integer">
		SELECT
			COUNT(*) CNT
		FROM ROOM A
		<include refid="selectRoomListWhere"></include>
	</select>
	
	<sql id="selectRoomListWhere">
		<where>
			A.USE_AT = 'Y'
			<choose>
				<when test='noticeAt == "Y"'>
					AND A.NOTICE_AT = 'Y'
				</when>
				<otherwise>
					<if test='searchCondition != null and searchCondition != ""'>
						<choose>
							제목
							<when test='searchCondition == "0"'>
								AND A.BOARD_SJ LIKE CONCAT('%', #{searchKeyword}, '%')
							</when>
							내용
							<when test='searchCondition == "1"'>
								AND A.BOARD_CN LIKE CONCAT('%', #{searchKeyword}, '%')
							</when>
							작성자							
							<when test='searchCondition == "2"'>
								AND A.FRST_REGISTER_ID LIKE CONCAT('%', #{searchKeyword}, '%')
							</when>
						</choose>
					</if>
				</otherwise>
			</choose>
		</where>
	</sql>
	
	<insert id="insertRoom" parameterType="egovframework.let.room.service.RoomVO">
		INSERT INTO ROOM (
			ROOM_ID, 
			REGISTER_INFO, 
			ADDRESS1, 
			ADDRESS2, 
			DEAL, 
			PRICE, 
			MONTH_PRICE, 
			COST, 
			COST_INFO, 
			MOVE_DATE, 
			WHOLE_CLASS, 
			MY_CLASS, 
			FORM, 
			PARK, 
			CHOICE_OPTION, 
			ATCH_FILE_ID, 
			BOARD_CN
		) VALUES (
			#{roomId}
			, #{registerInfo}
			, #{address1}
			, #{address2}
			, #{deal}
			, #{price}
			, #{monthPrice}
			, #{monthPrice}
			, #{cost}
			, #{costInfo}
			, #{moveDate} 
			, #{wholeClass}
			, #{myClass}
			, #{form}
			, #{park}
			, #{choiceOption}
			, #{atchFileId}
			, #{boardCn}
		)		
	</insert>
	
	<select id="selectRoom" resultMap="room">
		SELECT
			ROOM_ID, 
			REGISTER_INFO, 
			ADDRESS1, 
			ADDRESS2, 
			DEAL, 
			PRICE, 
			MONTH_PRICE, 
			COST, 
			COST_INFO, 
			MOVE_DATE, 
			WHOLE_CLASS, 
			MY_CLASS, 
			FORM, 
			PARK, 
			CHOICE_OPTION, 
			ATCH_FILE_ID, 
			BOARD_CN
		FROM ROOM
		WHERE ROOM_ID = #{roomId}
			AND USE_AT = 'Y'
	</select>
	
	<update id="updateViewCnt" parameterType="egovframework.let.room.service.RoomVO">
		UPDATE ROOM SET
			INQIRE_CO = INQIRE_CO + 1
		WHERE ROOM_ID = #{roomId}
	</update>
	
	<update id="updateRoom" parameterType="egovframework.let.room.service.RoomVO">
		UPDATE ROOM SET
			ADDRESS1 = #{address1}
			, ADDRESS2 = #{address2}
			, DEAL = #{deal}
			, PRICE = #{price}
			, MONTH_PRICE = #{monthPrice}
			, COST = #{cost}
			, COST_INFO = #{costInfo}
			, MOVE_DATE = #{moveDate}
			, WHOLE_CLASS = #{wholeClass}
			, MY_CLASS = #{myClass}
			, FORM = #{form}
			, PARK = #{park}
			, CHOICE_OPTION = #{choiceOption}
			<if test='atchFileId != null and atchFileId != ""'>
				, ATCH_FILE_ID = #{atchFileId}
			</if>
			, BOARD_CN = #{boardCn}
		WHERE ROOM_ID = #{roomId}
	</update>
	
	<update id="deleteRoom" parameterType="egovframework.let.room.service.RoomVO">
		UPDATE ROOM SET
			USE_AT = 'N'
		WHERE ROOM_ID = #{roomId}
	</update> -->
</mapper>